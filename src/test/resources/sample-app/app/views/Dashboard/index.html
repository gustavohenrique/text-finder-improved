#{extends 'main.html' /}

#{set 'myscripts'}
<link rel="stylesheet" media="all" href="@{'/public/stylesheets/black-tie/jquery-ui-1.8.16.custom.css'}">

<script type="text/javascript" src="@{'/public/javascripts/jquery-ui-1.8.16.custom.min.js'}"></script>

<script type="text/javascript">
/*
function colorize(id, min, max, invert) {
    var element = $('#'+id);
    var color = "#BFAB2A";
    var num = element.text();
    if (invert) {
        if (num > min) color = "red";
        if (num < max) color = "green";
    } else {
        if (num < min) color = "red";
        if (num > max) color = "green";
    }
    element.css('color', color);
};
*/
$(document).ready( function() {
    /*
    colorize('totalUnitestErrorsPercentual', 20, 5, true);
    colorize('commentsPercentual', 5, 10, true);
    colorize('javadocsPercentual', 15, 30);
    colorize('rejectedReleasesPercentual', 1, 1, true);
    colorize('averageBuildTimeBsad2', 15, 25, true);
    colorize('averageBuildTimeBsad3', 10, 20, true);
    colorize('totalComponentsReusedPercentual', 20, 50);
    colorize('totalBsraComponentsReusedPercentual', 20, 50);
    */
    
    $("#tabs").tabs();
});

</script>
#{/}

#{set title: 'Indicadores' /}

#{set 'combobox'}
<div class="combobox">
    #{form @Dashboard.index() , id:'filter'}
          <select name="date" class="" style="width:100px;" onchange="$('#filter').submit()">
              #{list items:allExtractions, as:'e'}
                  <option value="${e.extractionDate}" #{if e.extractionDate == currentDate}selected="true"#{/}>
                      ${e.extractionDate?.format('MM/yyyy')}
                  </option>
              #{/list}
          </select>
   #{/form}
</div>
#{/}


#{if extraction?.totalLines == 0}
    <div class="message errormsg">
        <p>Nenhuma extra&ccedil;&atilde;o realizada em ${e.extractionDate?.format('dd/MM/yyyy')}</p>
    </div>
#{/if}

#{else}

<div id="tabs" style="background:white">
    <ul>
        <li><a href="#tabs-1">Resumo dos Indicadores referente ao m&ecirc;s ${currentDate?.format('MM/yyyy')}</a></li>
        <li><a href="#tabs-2">Extra&ccedil;&atilde;o referente ao m&ecirc;s ${currentDate?.format('MM/yyyy')}</a></li>
    </ul>

    <div id="tabs-1" class="block">
   
       <div class="block small left">
            <table class="extraction" cellpadding="0" cellspacing="0" width="100%">
                <thead>
                    <tr>
                        <th scope="col">Qualidade</th>
                        <th scope="col" width="80"></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Cobertura em testes unit&aacute;rios</td>
                        <td><span id="totalUnitestCoveragePercentual">1</span>%</td>
                    </tr>
                    <tr>
                        <td>Erros em testes unit&aacute;rios</td>
                        <td><span id="totalUnitestErrorsPercentual">0</span>%</td>
                    </tr>
                    <tr>
                        <td>Coment&aacute;rios</td>
                        <td><span id="commentsPercentual">${consolided?.commentsPercentual}</span>%</td>
                    </tr>
                    <tr>
                        <td>Javadoc</td>
                        <td><span id="javadocsPercentual">${consolided?.javadocsPercentual}</span>%</td>
                    </tr>
                    <tr>
                        <td>Releases n&atilde;o aceitos</td>
                        <td><span id="rejectedReleasesPercentual">${consolided?.rejectedReleasesPercentual}</span>%</td>
                    </tr>
                </tbody>
            </table>
       </div>
       
       <div class="block small right">
            <table class="extraction" cellpadding="0" cellspacing="0" width="100%">
                <thead>
                    <tr>
                        <th scope="col">Produtividade</th>
                        <th scope="col" width="80"></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>M&eacute;dia de constru&ccedil;&atilde;o BSAD2</td>
                        <td><span id="averageBuildTimeBsad2">${consolided?.averageBuildTimeBsad2}</span> min</td>
                    </tr>
                    <tr>
                        <td>M&eacute;dia de constru&ccedil;&atilde;o BSAD3</td>
                        <td><span id="averageBuildTimeBsad3">${consolided?.averageBuildTimeBsad3}</span> min</td>
                    </tr>
                    <tr>
                        <td>Projetos cadastrados</td>
                        <td><span id="totalJobs">${consolided?.totalJobs}</span></td>
                    </tr>
                    <tr>
                        <td>Projetos ativos</td>
                        <td><span id="totalEnabledJobs">${consolided?.totalEnabledJobs}</span></td>
                    </tr>
                    <tr>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                    </tr>
                </tbody>
            </table>
       </div>
       
       <div class="clear"></div>
       
       <div class="block left" style="background:none">
            <table class="extraction" cellpadding="0" cellspacing="0" width="100%">
                <thead>
                    <tr>
                        <th scope="col">Economia</th>
                        <th scope="col" width="80"></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Total de ativos cadastrados no BSRA</td>
                        <td><span id="totalComponents">${consolided?.totalComponents}</span></td>
                    </tr>
                    <tr>
                        <td>Quantidade de ativos reutilizados no IC</td>
                        <td><span id="componentsReused">${consolided?.totalComponentsReused}</span></td>
                    </tr>
                    <tr>
                        <td>Quantidade de ativos <b>&uacute;nicos</b> reutilizados</td>
                        <td><span id="totalUniqueComponents">${consolided?.totalUniqueComponents}</span></td>
                    </tr>
                    <tr>
                        <td>Taxa de reuso de ativos no IC</td>
                        <td><span id="totalComponentsReusedPercentual">${consolided?.totalComponentsReusedPercentual}</span>%</td>
                    </tr>
                    <tr>
                        <td>Taxa de reuso de ativos total (BSRA)</td>
                        <td><span id="totalBsraComponentsReusedPercentual">${consolided?.totalBsraComponentsReusedPercentual}</span>%</td>
                    </tr>
                </tbody>
            </table>
       </div>
    </div>
       
    <div  id="tabs-2" class="block">
       
	   <div class="block small left">
	       
	        <table class="extraction" cellpadding="0" cellspacing="0" width="100%">
	            <thead>
	                <tr>
	                    <th scope="col" colspan="2">Qualidade de C&oacute;digo</th>
	                </tr>
	            </thead>
	            <tbody>
	                <tr>
	                    <td>C&oacute;digo Fonte</td>
	                    <td id="totalSources" width="80">${consolided?.totalSources}</td>
	                </tr>
	                <tr>
	                    <td>Coment&aacute;rios</td>
	                    <td id="totalComments">${consolided?.totalComments}</td>
	                </tr>
	                <tr>
	                    <td>Javadoc</td>
	                    <td id="totalJavadocs">${consolided?.totalJavadocs}</td>
	                </tr>
	                <tr>
	                    <td>Linhas Total</td>
	                    <td id="totalLines">${consolided?.totalLines}</td>
	                </tr>
	            </tbody>
	        </table>
	   </div>
	   
	   <div class="block small right">
	        <table class="extraction" cellpadding="0" cellspacing="0" width="100%">
	            <thead>
	                <tr>
	                    <th scope="col" colspan="2">Reuso de Ativos</th>
	                </tr>
	            </thead>
	            <tbody>
	                <tr>
	                    <td>Cobol</td>
	                    <td id="totalCobol" width="80">${consolided?.totalCobol}</td>
	                </tr>
	                <tr>
	                    <td>EJB</td>
	                    <td id="totalEjb">${consolided?.totalEjb}</td>
	                </tr>
	                <tr>
	                    <td>Webservices</td>
	                    <td id="totalWebservice">${consolided?.totalWebservice}</td>
	                </tr>
	                <tr>
	                    <td>Total</td>
	                    <td id="totalComponentsReused">${consolided?.totalComponentsReused}</td>
	                </tr>
	            </tbody>
	        </table>
	    </div>
	    
	    <div class="clear"></div>
	   
	    <div class="block small left">
	        <table class="extraction" cellpadding="0" cellspacing="0" width="100%">
	            <thead>
	                <tr>
	                    <th scope="col" colspan="3">Avalia&ccedil;&atilde;o de Releases</th>
	                </tr>
	            </thead>
	            <tbody>
	                <tr>
	                    <td>Criados</td>
	                    <td  id="totalCreatedReleases" width="80">${consolided?.totalCreatedReleases}</td>
	                </tr>
	                <tr>
	                    <td>N&atilde;o Aceitos</td>
	                    <td id="totalRejectedReleases">${consolided?.totalRejectedReleases}</td>
	                </tr>
	                <tr>
	                    <td>Avaliados</td>
	                    <td id="totalValuedReleases">${consolided?.totalValuedReleases}</td>
	                </tr>
	            </tbody>
	        </table>
	    </div>
	    
	    <div class="block small right">
	        <table class="extraction" cellpadding="0" cellspacing="0" width="100%">
	            <thead>
	                <tr>
	                    <th scope="col" colspan="3">Avalia&ccedil;&atilde;o de Builds</th>
	                </tr>
	            </thead>
	            <tbody>
	                <tr>
	                    <td>Avaliados</td>
	                    <td  id="totalValuedBuilds" width="80">${consolided?.totalValuedBuilds}</td>
	                </tr>
	                <tr><td>&nbsp;</td><td>&nbsp;</td></tr>
	                <tr><td>&nbsp;</td><td>&nbsp;</td></tr>
	            </tbody>
	        </table>
	    </div>
	
	    <div class="clear"></div>
	    
	</div>

</div>
#{/}
